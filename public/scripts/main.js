!function(){"use strict";var e=document.querySelector(".items"),t=document.querySelector('[data-form="add-item"]'),n=document.querySelector('[name="add-item"]'),a=document.querySelector('[data-input-error="add-item"]'),r=document.querySelector(".modal"),o=r.querySelector(".modal-content").querySelector(".modal-message");function i(e){e.classList.add("delete")}function l(){for(;e.firstChild;)e.removeChild(e.firstChild)}function d(e,t){var n;(n=e.querySelector(".slide-transition")).style.maxHeight?n.style.maxHeight=null:n.style.maxHeight=n.scrollHeight+"px";var a=e.querySelector(".item-name");a.disabled?function(e){e.disabled=!1,e.focus();var t=e.value.length;e.setSelectionRange(t,t)}(a):function(e,t){var n=void 0!==t&&t;e.disabled=!0,n&&(e.value=e.dataset.value)}(a,t)}function s(e,t){return'<p>Sorry.</p><p class="error-message">'+e+".</p>"+(void 0===t||t?"<p>Please try again later.</p>":"")}function c(e){o.innerHTML=e,r.style.display="flex"}function u(){r.style.display="none"}t&&t.addEventListener("submit",(function(t){t.preventDefault();var r,o=n.value.trim();if(o.length<1)return r="Item cannot be empty.",a.textContent=r,n.classList.add("error-border"),void n.focus();fetch("/api/items/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o,ui:!0})}).then((function(e){if(!e.ok)throw new Error("API response was not ok.");return e.text()})).then((function(t){var a,r;n.value="",a=t,e.insertAdjacentHTML("afterbegin",a),(r=e.firstElementChild).style.maxHeight=r.scrollHeight+"px",r.style.opacity=1})).catch((function(){c(s("Could not add "+o))}))})),n&&n.addEventListener("input",(function(e){this.matches(".error-border")&&/\S/.test(e.data)&&"deleteContentBackward"!==e.inputType&&(a.textContent="",n.classList.remove("error-border"))})),document.addEventListener("transitionend",(function(t){var n;if(!t.target.matches(".item.delete"))return t.target.matches(".item.enter")?((n=t.target).classList.remove("enter"),void n.removeAttribute("style")):void 0;e.removeChild(t.target)})),document.documentElement.addEventListener("click",(function(t){if(t.target===r||t.target.closest(".close-modal")||t.target.matches('[data-modal-btn="cancel"]'))return t.preventDefault(),void u();if(t.target.matches('[data-modal-btn="delete_all"]'))return t.preventDefault(),u(),void(e.firstElementChild&&fetch("/api/items/",{method:"DELETE"}).then(l).catch((function(){c(s("Could not delete all items"))})));var n,a,o,m,f=t.target.closest(".item");return t.target.closest('[data-item-btn="delete"]')?(t.preventDefault(),void function(e){e.blur();var t=e.dataset.itemId;fetch("/api/items/"+t,{method:"DELETE"}).then((function(t){if(!t.ok)throw new Error("API response was not ok.");i(e)})).catch((function(){c(s("Could not delete "+(e.querySelector(".item-name").value||"item")))}))}(f)):t.target.closest('[data-item-btn="edit"]')?(t.preventDefault(),void d(f,!0)):t.target.closest('[data-item-btn="update"]')?(t.preventDefault(),a=(n=f).dataset.itemId,o=n.querySelector(".item-name"),void((m=o.value.trim()).length<1||m===o.dataset.value?d(n,!0):fetch("/api/items/"+a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:m,ui:!0})}).then((function(e){if(!e.ok)throw new Error("API response was not ok.");return e.json()})).then((function(e){if(404===e.error)return c(s("The item has been deleted by someone else",!1)),void i(n);o.dataset.value=e.name,o.value=e.name,d(n)})).catch((function(){c(s("Could not update "+m))})))):t.target.closest('[data-btn="delete all"]')?(t.preventDefault(),void c('<p>Reminder.</p><p class="error-message">This will delete all items.</p><div class="margin-top"><button class="btn cancel-btn" data-modal-btn="cancel">No, cancel</button><button class="btn delete-btn" data-modal-btn="delete_all">Yes, delete</button></div>')):void 0}),!1)}();
//# sourceMappingURL=main.js.map
